{"version":3,"file":"utils.js","sources":["../src/utils.js"],"sourcesContent":["import { TIMINGS, TIMELINE_DATA_POINT_HEIGHT } from './constants';\n\n/* eslint no-underscore-dangle: 0 */\n\nexport const roundOff = (value, decimal = 1) => {\n  const base = 10 ** decimal;\n  return Math.round(value * base) / base;\n};\n\nexport const formatSize = (bytes) => {\n  if (bytes < 1024) {\n    return `${roundOff(bytes)} B`;\n  }\n  if (bytes < (1024 ** 2)) {\n    return `${roundOff(bytes / 1024)} KB`;\n  }\n  return `${roundOff(bytes / (1024 ** 2))} MB`;\n};\n\nexport const formatTime = (time) => {\n  if (time < 1000) {\n    return `${Math.round(time)}ms`;\n  }\n  if (time < 60000) {\n    return `${Math.ceil(time / 10) / 100}s`;\n  }\n  return `${(Math.ceil(time / 60000) * 100) / 100}m`;\n};\n\nexport const getUrlInfo = (url) => {\n  const urlInfo = new URL(url);\n  const pathSplit = urlInfo.pathname.split('/');\n  const fileName = (\n    pathSplit[pathSplit.length - 1].trim() ?\n      pathSplit[pathSplit.length - 1] : pathSplit[pathSplit.length - 2]\n  ) + urlInfo.search;\n\n  return {\n    domain: urlInfo.host,\n    filename: fileName || urlInfo.href,\n    url: urlInfo.href,\n  };\n};\n\nexport const parseSize = ({ bodySize, _transferSize, headers, content }) => {\n  if (content && content.size) {\n    return formatSize(content.size);\n  }\n  if (_transferSize > -1) {\n    return formatSize(_transferSize);\n  }\n  if (bodySize > -1) {\n    return formatSize(bodySize);\n  }\n  const contentInfo = headers.find(({ name }) => ['content-length', 'Content-Length'].includes(name));\n  if (!contentInfo) {\n    return 0;\n  }\n\n  return formatSize(contentInfo.value);\n};\n\nexport const getContentType = (entry) => {\n  if (entry._resourceType) {\n    return entry._resourceType.toLowerCase();\n  }\n\n  const { headers } = entry.response;\n  const contentInfo = headers.find(({ name }) => ['content-type', 'Content-Type'].includes(name));\n  if (!contentInfo) {\n    return '';\n  }\n  const type = contentInfo.value.split(';')[0].split('/');\n  return type.length > 1 ? type[1] : type[0];\n};\n\nexport const getTimings = ({ startedDateTime, timings }, firstEntryTime) => ({\n  ...timings,\n  startTime: new Date(startedDateTime).getTime() - new Date(firstEntryTime).getTime(),\n});\n\nexport const getContent = ({ mimeType, text }) => {\n  if (mimeType === 'application/json') {\n    let parsedJson = text;\n    try {\n      parsedJson = JSON.stringify(JSON.parse(text), null, 2);\n    } catch (err) {\n      parsedJson = text;\n    }\n    return parsedJson;\n  }\n\n  return text;\n};\n\nexport const getEntryTransferredSize = ({ response }) => {\n  const { bodySize, _transferSize } = response;\n  if (_transferSize > -1) {\n    return _transferSize;\n  }\n\n  if (bodySize > -1) {\n    return bodySize;\n  }\n  return -1;\n};\n\nexport const getEntryUncompressedSize = ({ response }) => {\n  const { bodySize, _transferSize, content: { size } } = response;\n  if (size > 0) {\n    return size;\n  }\n  if (_transferSize > -1) {\n    return _transferSize;\n  }\n  if (bodySize > -1) {\n    return bodySize;\n  }\n  return -1;\n};\n\nexport const calculateFinishTime = (data) => {\n  const finishTimes = data.map(({ timings }) => (\n    Object.values(timings).reduce((acc, durationInMS) => (\n      acc + (durationInMS > -1 ? durationInMS : 0)\n    ), 0)));\n  return Math.max(...finishTimes);\n};\n\nexport const sortHeaders = (current, next) => {\n  if (current.name < next.name) {\n    return -1;\n  }\n  return current.name > next.name ? 1 : 0;\n};\n\nexport const getHeaders = (entry) => ({\n  request: entry.request.headers.sort(sortHeaders),\n  response: entry.response.headers.sort(sortHeaders),\n  queryString: entry.request.queryString,\n  postData: entry.request.postData,\n});\n\nexport const getTotalTimeOfEntry = ({ startedDateTime, time, timings }) => (\n  new Date(startedDateTime).getTime() + time + (timings._blocked_queueing || 0)\n);\n\nexport const getInterceptError = ({ response }) => (\n  response && response._error ? response._error : null\n);\n\nexport const prepareViewerData = (entries) => {\n  if (!entries.length) {\n    return {\n      totalNetworkTime: 0,\n      data: [],\n      totalRequests: 0,\n      totalTransferredSize: 0,\n      totalUncompressedSize: 0,\n      finishTime: 0,\n    };\n  }\n\n  const firstEntryTime = entries[0].startedDateTime;\n  let endTime = getTotalTimeOfEntry(entries[entries.length - 1]);\n  let totalTransferredSize = 0;\n  let totalUncompressedSize = 0;\n  const data = entries\n    .filter((entry) => entry.response && getUrlInfo(entry.request.url).domain)\n    .map((entry, index) => {\n      totalTransferredSize += getEntryTransferredSize(entry);\n      totalUncompressedSize += getEntryUncompressedSize(entry);\n      const lastTimeOfEntry = getTotalTimeOfEntry(entry);\n      endTime = endTime < lastTimeOfEntry ? lastTimeOfEntry : endTime;\n      return {\n        index,\n        status: entry.response.status,\n        method: entry.request.method,\n        size: parseSize(entry.response),\n        startedDateTime: new Date(entry.startedDateTime).getTime(),\n        type: getContentType(entry),\n        timings: getTimings(entry, firstEntryTime),\n        body: getContent(entry.response.content),\n        time: entry.time,\n        serverIPAddress: entry.serverIPAddress || ':80',\n        headers: getHeaders(entry),\n        transferredSize: getEntryTransferredSize(entry),\n        uncompressedSize: getEntryUncompressedSize(entry),\n        error: getInterceptError(entry),\n        ...getUrlInfo(entry.request.url),\n      };\n    });\n\n  const totalRequests = data.length;\n  const totalNetworkTime = endTime - new Date(firstEntryTime).getTime();\n  const finishTime = calculateFinishTime(data);\n  return {\n    totalNetworkTime,\n    data,\n    totalRequests,\n    totalTransferredSize,\n    totalUncompressedSize,\n    finishTime,\n  };\n};\n\nexport const sortBy = (data, key, isAsc = true) => data.sort((prev, next) => {\n  if (prev[key] < next[key]) {\n    return isAsc ? -1 : 1;\n  }\n  if (prev[key] > next[key]) {\n    return isAsc ? 1 : 1;\n  }\n  return 0;\n});\n\nexport const filterCondition = ({ filter, info }) => {\n  switch (filter.name) {\n    case 'error':\n      return info.status >= 400 || info.error;\n    case 'type':\n    default:\n      return filter.value.includes(info[filter.name]);\n  }\n};\n\nexport const filterData = ({\n  data,\n  errorFilter,\n  filter = {},\n  search = {},\n}) => {\n  const trimmedSearch = search.value && search.value.trim();\n\n  return !trimmedSearch && !filter.name && !errorFilter ?\n    data :\n    data.filter((info) => {\n      const isSearchMatched = trimmedSearch ?\n        info[search.name] && info[search.name].includes(trimmedSearch) : true;\n      const isErrorMatched = errorFilter ? filterCondition({ filter: { name: 'error' }, info }) : true;\n      const isFilterMatched = filter.name ? filterCondition({ filter, info }) : true;\n      return isSearchMatched && isErrorMatched && isFilterMatched;\n    });\n};\n\nexport const actionsWrapper = (actions = {}) => (dispatch, state) => Object.keys(actions)\n  .reduce((modifiedActions, type) => ({\n    ...modifiedActions,\n    [type]: actions[type](dispatch, state),\n  }), {});\n\nexport const parseTime = (time) => {\n  if (!time) {\n    return time;\n  }\n\n  if (time > 1000) {\n    return `${(time / 1000).toFixed(2)} s`;\n  }\n\n  return `${time.toFixed(2)} ms`;\n};\n\nexport const calcTotalTime = (data) => {\n  const total = Object.keys(data)\n    .filter((key) => !['_blocked_queueing', 'startTime'].includes(key))\n    .reduce((acc, key) => acc + data[key], 0);\n  return total;\n};\n\nexport const prepareTooltipData = (data) => ({\n  queuedAt: parseTime(data.startTime),\n  startedAt: parseTime(data.startTime + data._blocked_queueing),\n  totalTime: parseTime(calcTotalTime(data)),\n  ...(Object.keys(data).reduce((acc, key) => {\n    acc[key] = parseTime(data[key]);\n    return acc;\n  }, {})\n  ),\n});\n\nexport const getStatusClass = ({ status, error }) => {\n  if (status === 0 && !error) {\n    return 'pending';\n  }\n  if (status >= 400 || error) {\n    return 'error';\n  }\n  return 'info';\n};\n\nexport const formatValue = (key, value, unit, request = {}) => {\n  switch (key) {\n    case 'time':\n      return value === 0 && !request.error ? 'Pending' : parseTime(value);\n    case 'status':\n      if (request.error) {\n        return '(failed)';\n      }\n      return value === 0 ? 'Pending' : value;\n    default:\n      return !unit ? value : `${value} ${unit}`;\n  }\n};\n\nexport const calcChartAttributes = (data, maxTime, cx, index, cy = null) => {\n  const startTimePercent = (data.startTime / maxTime) * 100;\n  let previousX = 0;\n  let previousWidth = 0;\n  const chartAttributes = [];\n\n  Object.keys(TIMINGS).forEach((key) => {\n    const timingInfo = TIMINGS[key];\n    const value = data[timingInfo.dataKey];\n    if (value <= 0) {\n      return;\n    }\n\n    previousX += !previousWidth ? startTimePercent : previousWidth;\n    previousWidth = value > 0 ? (value / maxTime) * 100 : 0;\n\n    chartAttributes.push({\n      width: `${previousWidth}%`,\n      y: index ? ((index % 10) * (TIMELINE_DATA_POINT_HEIGHT + 1)) + 40 : cy,\n      x: `${previousX}%`,\n      fill: timingInfo.fill,\n      key,\n    });\n  });\n\n  return chartAttributes;\n};\n\nexport const findIndexNearTimestamp = (data, exactTimestamp) => (\n  data.reduce((\n    { value, index }, { startedDateTime: currentValue, index: currentIndex }) => (\n    Math.abs(currentValue - exactTimestamp) < Math.abs(value - exactTimestamp) ?\n      { value: currentValue, index: currentIndex } : { value, index }\n  ), { value: 0, index: 0 }).index\n);\n\nexport const findIndexBeforeTimestamp = (data, exactTimestamp) => {\n  const resultIndex = data.reverse()\n    .findIndex(({ startedDateTime }) => startedDateTime <= exactTimestamp);\n  return resultIndex < 0 ? 0 : data.size - (resultIndex + 1);\n};\n\nexport const findIndexAfterTimestamp = (data, exactTimestamp) => (\n  data.findIndex(({ startedDateTime }) => startedDateTime >= exactTimestamp)\n);\n\nexport const findRequestIndex = ({ data, timestamp, position }) => {\n  switch (position) {\n    case 'before':\n      return findIndexBeforeTimestamp(data, timestamp);\n    case 'after':\n      return findIndexAfterTimestamp(data, timestamp);\n    case 'near':\n    default:\n      return findIndexNearTimestamp(data, timestamp);\n  }\n};\n\nexport const calculateTimings = (pages) => (\n  pages.reduce(({ DOMContentLoaded, onLoad }, { pageTimings }) => ({\n    DOMContentLoaded: DOMContentLoaded + pageTimings.onContentLoad,\n    onLoad: onLoad + pageTimings.onLoad,\n  }), { DOMContentLoaded: 0, onLoad: 0 }));\n\nexport const getSummary = (data) => (\n  data.reduce((acc, req) => {\n    acc.totalTransferredSize += req.transferredSize;\n    acc.totalUncompressedSize += req.uncompressedSize;\n    return acc;\n  }, {\n    totalTransferredSize: 0,\n    totalUncompressedSize: 0,\n    totalRequests: data.size,\n  })\n);\n\nexport const parseRequestPayload = (text) => {\n  let parsedJson = text;\n  try {\n    parsedJson = JSON.stringify(JSON.parse(text), null, 2);\n  } catch (err) {\n    parsedJson = text;\n  }\n  return parsedJson;\n};\n"],"names":["roundOff","value","decimal","base","Math","round","formatSize","bytes","formatTime","time","ceil","getUrlInfo","url","urlInfo","URL","pathSplit","pathname","split","fileName","length","trim","search","domain","host","filename","href","parseSize","bodySize","_transferSize","headers","content","size","contentInfo","find","name","includes","getContentType","entry","_resourceType","toLowerCase","response","type","getTimings","firstEntryTime","startedDateTime","timings","startTime","Date","getTime","getContent","mimeType","text","parsedJson","JSON","stringify","parse","err","getEntryTransferredSize","getEntryUncompressedSize","calculateFinishTime","data","finishTimes","map","Object","values","reduce","acc","durationInMS","max","sortHeaders","current","next","getHeaders","request","sort","queryString","postData","getTotalTimeOfEntry","_blocked_queueing","getInterceptError","_error","prepareViewerData","entries","totalNetworkTime","totalRequests","totalTransferredSize","totalUncompressedSize","finishTime","endTime","filter","index","lastTimeOfEntry","status","method","body","serverIPAddress","transferredSize","uncompressedSize","error","sortBy","key","isAsc","prev","filterCondition","info","filterData","errorFilter","trimmedSearch","isSearchMatched","isErrorMatched","isFilterMatched","actionsWrapper","actions","dispatch","state","keys","modifiedActions","parseTime","toFixed","calcTotalTime","total","prepareTooltipData","queuedAt","startedAt","totalTime","getStatusClass","formatValue","unit","calcChartAttributes","maxTime","cx","cy","startTimePercent","previousX","previousWidth","chartAttributes","TIMINGS","forEach","timingInfo","dataKey","push","width","y","TIMELINE_DATA_POINT_HEIGHT","x","fill","findIndexNearTimestamp","exactTimestamp","currentValue","currentIndex","abs","findIndexBeforeTimestamp","resultIndex","reverse","findIndex","findIndexAfterTimestamp","findRequestIndex","timestamp","position","calculateTimings","pages","DOMContentLoaded","onLoad","pageTimings","onContentLoad","getSummary","req","parseRequestPayload"],"mappings":"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"}