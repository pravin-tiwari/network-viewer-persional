{"version":3,"file":"reducer.js","sources":["../../../src/state/network/reducer.js"],"sourcesContent":["import { Map, List } from 'immutable';\n\nimport { filterData, sortBy, prepareViewerData, calculateTimings, getSummary } from './../../utils';\nimport * as types from './types';\n\nconst initialState = new Map({\n  data: new List(),\n  actualData: new List(),\n  totalNetworkTime: null,\n  dataSummary: new Map(),\n  sort: {\n    key: 'startedDateTime',\n    isAcs: true,\n  },\n  search: {\n    name: 'url',\n    value: '',\n  },\n  filter: {\n    name: null,\n    value: null,\n  },\n  errorFilter: false,\n  error: null,\n  loading: false,\n  scrollToIndex: null,\n  selectedReqIndex: null,\n  showReqDetail: false,\n  reqDetail: null,\n});\n\nconst reducer = (state = initialState, { type, payload }) => {\n  switch (type) {\n    case types.UPDATE_DATA: {\n      return state.withMutations((newState) => {\n        const sort = state.get('sort');\n        const {\n          data,\n          totalNetworkTime,\n          totalRequests,\n          totalTransferredSize,\n          totalUncompressedSize,\n          finishTime,\n        } = prepareViewerData(payload.entries);\n        const sortedData = new List(sortBy(data, sort.key, sort.isAcs));\n        newState\n          .set('error', null)\n          .set('data', sortedData)\n          .set('actualData', sortedData)\n          .set('totalNetworkTime', totalNetworkTime)\n          .set('dataSummary', new Map({\n            totalRequests,\n            totalTransferredSize,\n            totalUncompressedSize,\n            finishTime,\n            timings: calculateTimings(payload.pages),\n            finish: finishTime,\n          }));\n      });\n    }\n    case types.UPDATE_SEARCH: {\n      return state.withMutations((newState) => {\n        const data = filterData({\n          data: state.get('actualData'),\n          filter: state.get('filter'),\n          search: payload,\n          errorFilter: state.get('errorFilter'),\n        });\n        const summary = getSummary(data);\n        newState\n          .set('search', payload)\n          .set('data', data)\n          .setIn(['dataSummary', 'totalRequests'], summary.totalRequests)\n          .setIn(['dataSummary', 'totalTransferredSize'], summary.totalTransferredSize)\n          .setIn(['dataSummary', 'totalUncompressedSize'], summary.totalUncompressedSize);\n      });\n    }\n    case types.UPDATE_FILTER: {\n      return state.withMutations((newState) => {\n        const data = filterData({\n          data: state.get('actualData'),\n          filter: payload,\n          search: state.get('search'),\n          errorFilter: state.get('errorFilter'),\n        });\n        const summary = getSummary(data);\n        newState\n          .set('filter', payload)\n          .set('data', data)\n          .setIn(['dataSummary', 'totalRequests'], summary.totalRequests)\n          .setIn(['dataSummary', 'totalTransferredSize'], summary.totalTransferredSize)\n          .setIn(['dataSummary', 'totalUncompressedSize'], summary.totalUncompressedSize);\n      });\n    }\n    case types.UPDATE_ERROR_FILTER: {\n      return state.withMutations((newState) => {\n        const data = filterData({\n          data: state.get('actualData'),\n          filter: state.get('filter'),\n          search: state.get('search'),\n          errorFilter: payload,\n        });\n        const summary = getSummary(data);\n        newState\n          .set('errorFilter', payload)\n          .set('data', data)\n          .setIn(['dataSummary', 'totalRequests'], summary.totalRequests)\n          .setIn(['dataSummary', 'totalTransferredSize'], summary.totalTransferredSize)\n          .setIn(['dataSummary', 'totalUncompressedSize'], summary.totalUncompressedSize);\n      });\n    }\n    case types.UPDATE_SORT: {\n      return state.withMutations((newState) => {\n        newState\n          .set('sort', payload)\n          .set('data', sortBy(state.get('data'), payload.key, payload.isAcs));\n      });\n    }\n    case types.FETCH_FILE.REQUEST: {\n      return state.withMutations((newState) => {\n        newState\n          .set('error', null)\n          .set('loading', true);\n      });\n    }\n    case types.FETCH_FILE.SUCCESS: {\n      return state.withMutations((newState) => {\n        newState\n          .set('error', null)\n          .set('loading', false);\n      });\n    }\n    case types.FETCH_FILE.FAILURE:\n    case types.UPDATE_ERROR_MESSAGE: {\n      return state.withMutations((newState) => {\n        newState\n          .set('error', payload)\n          .set('loading', false);\n      });\n    }\n    case types.UPDATE_SCROLL_TO_INDEX: {\n      return state.withMutations((newState) => {\n        newState\n          .set('selectedReqIndex', payload ? payload.index : null)\n          .set('reqDetail', payload);\n      });\n    }\n    case types.SELECT_REQUEST: {\n      return state.withMutations((newState) => {\n        newState\n          .set('selectedReqIndex', payload ? payload.index : null)\n          .set('reqDetail', payload)\n          .set('showReqDetail', !!payload);\n      });\n    }\n    case types.RESET: {\n      return initialState;\n    }\n    default:\n      return state;\n  }\n};\n\nexport { initialState, reducer };\nexport default reducer;\n"],"names":["initialState","Map","data","List","actualData","totalNetworkTime","dataSummary","sort","key","isAcs","search","name","value","filter","errorFilter","error","loading","scrollToIndex","selectedReqIndex","showReqDetail","reqDetail","reducer","state","type","payload","types","withMutations","newState","get","prepareViewerData","entries","totalRequests","totalTransferredSize","totalUncompressedSize","finishTime","sortedData","sortBy","set","timings","calculateTimings","pages","finish","filterData","summary","getSummary","setIn","REQUEST","SUCCESS","FAILURE","index"],"mappings":"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"}